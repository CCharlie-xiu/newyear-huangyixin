<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>回忆家宴 - 黄一心</title>
    <style>
        :root {
            --bg-color: #F4F4F2;
            --modal-bg: #FFFFFF;
            --primary-btn: #5E6DFF;
            --text-main: #181818;
            --text-sub: #777777;
        }

        body, html {
            margin: 0; padding: 0;
            background-color: var(--bg-color);
            font-family: -apple-system, system-ui, sans-serif;
            overflow: hidden; 
            touch-action: none; /* 防止拖拽时页面跟着滚 */
        }

        /* --- 初始弹窗 --- */
        #overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex; justify-content: center; align-items: center;
            z-index: 1000; backdrop-filter: blur(8px);
        }
        .modal {
            background: var(--modal-bg);
            padding: 30px; border-radius: 24px;
            text-align: center; width: 80%; max-width: 300px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .heart { color: #FF85A1; font-size: 40px; animation: beat 0.8s infinite alternate; display: block; margin-bottom: 10px; }
        @keyframes beat { to { transform: scale(1.2); } }

        /* --- 主内容区 --- */
        #main-content { display: none; height: 100vh; overflow-y: auto; touch-action: auto; padding: 10px; box-sizing: border-box; }

        /* --- 双列瀑布流 --- */
        .waterfall {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* 强制两列 */
            grid-gap: 12px;
            grid-auto-rows: 5px; /* 精细化行高控制 */
            padding-bottom: 50px;
        }
        .photo-item {
            background: #fff; border-radius: 12px;
            overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            transition: 0.3s;
        }
        .photo-item img { width: 100%; display: block; object-fit: cover; }

        /* --- 可拖拽小窗 --- */
        #video-container {
            position: fixed;
            top: 20px; left: 20px;
            width: 140px; height: 100px;
            background: #000; border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
            z-index: 999;
            border: 2px solid #fff;
            overflow: hidden;
            touch-action: none; /* 必须，防止拖动冲突 */
            cursor: move;
        }
        #mini-video { width: 100%; height: 100%; object-fit: cover; }
        
        .btn-start {
            background: var(--primary-btn); color: white; border: none;
            padding: 12px 0; border-radius: 12px; width: 100%; cursor: pointer;
        }
    </style>
</head>
<body>

    <div id="overlay">
        <div class="modal">
            <span class="heart">❤</span>
            <h3 style="margin: 10px 0;">开启回忆</h3>
            <p style="color: var(--text-sub); font-size: 14px; margin-bottom: 20px;">记录我们的 2025</p>
            <button class="btn-start" onclick="startMemory()">点击回忆</button>
        </div>
    </div>

    <div id="main-content">
        <div id="video-container">
            <video id="mini-video" autoplay muted loop playsinline>
                <source src="your-video.mp4" type="video/mp4">
            </video>
        </div>

        <div class="waterfall" id="gallery"></div>
    </div>

    <audio id="bgm" loop><source src="your-music.mp3" type="audio/mpeg"></audio>

<script>
    function startMemory() {
        document.getElementById('overlay').style.display = 'none';
        document.getElementById('bgm').play().catch(() => {});
        const main = document.getElementById('main-content');
        main.style.display = 'block';
        
        loadPhotos();
        enableDrag(document.getElementById('video-container'));
    }

    // 生成双列瀑布流照片
    function loadPhotos() {
        const gallery = document.getElementById('gallery');
        const imgUrls = [
            'bfd88f76095952b3144bcf44aa52f04c.jpg', // 你的处理鱼图
            '100b115d8e3c77905f698846869657ff.jpg', // 你的切藕图
            'cfffc134e544608a86374e4e405ef613.jpg', // 你的全家福图
            '638f0aaf39b15560d2fb5aa2cc21a4cc.jpg', // 你的炒菜图
            '5e067548a4aa4a43a76512d471aac5ce.jpg'  // 你的用餐图
        ];

        // 循环生成50张模拟效果
        for (let i = 0; i < 50; i++) {
            const item = document.createElement('div');
            item.className = 'photo-item';
            const h = Math.floor(Math.random() * 100) + 150; // 随机高度
            const rowSpan = Math.ceil(h / 5);
            item.style.gridRowEnd = `span ${rowSpan}`;
            
            // 循环使用你上传的照片
            const url = imgUrls[i % imgUrls.length];
            item.innerHTML = `<img src="${url}" loading="lazy">`;
            gallery.appendChild(item);
        }
    }

    // 拖拽逻辑（兼容手机触摸与鼠标）
    function enableDrag(el) {
        let posX = 0, posY = 0, mouseX = 0, mouseY = 0;

        el.onmousedown = dragMouseDown;
        el.ontouchstart = dragMouseDown;

        function dragMouseDown(e) {
            e = e || window.event;
            // 获取初始坐标
            mouseX = e.clientX || e.touches[0].clientX;
            mouseY = e.clientY || e.touches[0].clientY;
            document.onmouseup = closeDragElement;
            document.ontouchend = closeDragElement;
            document.onmousemove = elementDrag;
            document.ontouchmove = elementDrag;
        }

        function elementDrag(e) {
            e = e || window.event;
            let cx = e.clientX || (e.touches ? e.touches[0].clientX : mouseX);
            let cy = e.clientY || (e.touches ? e.touches[0].clientY : mouseY);
            
            posX = mouseX - cx;
            posY = mouseY - cy;
            mouseX = cx;
            mouseY = cy;
            
            // 计算新位置并限制在视口内
            let top = el.offsetTop - posY;
            let left = el.offsetLeft - posX;
            
            // 简易边界检查
            if (top < 0) top = 0;
            if (left < 0) left = 0;
            if (top > window.innerHeight - 100) top = window.innerHeight - 100;
            if (left > window.innerWidth - 140) left = window.innerWidth - 140;

            el.style.top = top + "px";
            el.style.left = left + "px";
        }

        function closeDragElement() {
            document.onmouseup = null;
            document.onmousemove = null;
            document.ontouchend = null;
            document.ontouchmove = null;
        }
    }
</script>
</body>
</html>